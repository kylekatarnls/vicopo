jQuery(function(c){var n={},o=function(t,o){return t.city-o.city},i=function(){return!0};c.extend({vicopoSort:function(t){o=t},vicopoFilter:function(t){i=t},vicopoPrepare:function(t){return(t=t.filter(i)).sort(o)},vicopo:function(t,o){return t=t.trim(),this.getVicopo(/^\d+$/.test(t)?"code":"city",t,o)},codePostal:function(t,o){return this.getVicopo("code",t,o)},ville:function(t,o){return this.getVicopo("city",t,o)},getVicopo:function(o,i,e){if(1<i.length){if(i=i.trim(),n[o]=n[o]||{},!n[o][i]){var t={};return t[o]=i,c.getJSON("https://vicopo.selfbuild.fr",t,function(t){n[o][i]=t.cities,e(t.input,c.vicopoPrepare(t.cities||[]),o)})}e(i,c.vicopoPrepare(n[o][i]||[]),o)}else e(i,[],o)}}),c.fn.extend({vicopoClean:function(){return c(this).each(function(){for(var t=[],o=c(this).next();o.hasClass("vicopo-answer");o=o.next())t.push(o[0]);c(t).remove()})},vicopoTargets:function(){var o=[];return c(this).each(function(){var t=c(this);c("[data-vicopo]").each(function(){t.is(c(this).data("vicopo"))&&o.push(this)})}),c(o)},vicopoTarget:function(){return c(this).vicopoTargets().first()},getVicopo:function(t,n){return c(this).keyup(function(){var e=c(this);c[t](e.val(),function(t,o,i){t==e.val()&&n(o,i,t)})})},vicopo:function(t){return c(this).getVicopo("vicopo",t)},codePostal:function(t){return c(this).getVicopo("codePostal",t)},ville:function(t){return c(this).getVicopo("ville",t)}});var t="input, textarea, select";c(document).on("keyup change",t,function(){var t=c(this),o=t.val();if(t.data("vicopo-value")!==o){var i=t.data("vicopo-value",o).vicopoTargets().each(function(){c(this).hide().vicopoClean()});i.length&&o.length&&c.vicopo(o,function(t,e){t===o&&i.each(function(){var t=c(this).vicopoClean(),o=t.clone();o.show().removeAttr("data-vicopo");var i=[];c.each(e,function(){var t=o.clone();t.addClass("vicopo-answer"),t.find("[data-vicopo-code-postal]").text(this.code),t.find("[data-vicopo-ville]").text(this.city),t.find("[data-vicopo-val-code-postal]").val(this.code),t.find("[data-vicopo-val-ville]").val(this.city),i.push(t)}),t.after(i)})})}}),c(t).trigger("keyup")});